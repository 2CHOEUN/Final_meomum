<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.mm.order">
  	<select id="orderList" resultType="com.mm.pro.model.ProDTO">
  	select * from product where pro_idx= #{pro_idx}
  	</select>
  	<insert id="orderInsert" parameterType="com.mm.order.model.OrderDTO">
  		insert into orders values(31, #{user_idx}, 'r', sysdate, sysdate+ INTERVAL '1' MONTH, #{order_pcode}, 'r', 'r', #{order_addr}, #{order_detail}, 'r', 1, sysdate, 1, 1, sysdate, 'y')
	</insert>

	<select id="myOrderList" parameterType="Integer" resultType="com.mm.order.model.OrderDTO">
		select * from orders where user_idx=#{user_idx}
	</select>
	
	
	<select id="orderReport" parameterType="Map" resultType="com.mm.order.model.OrderDTO">
		select * from
			(select rownum as rnum, a.*from(
			select a.order_idx, d.pro_name, b.user_name, b.user_tel, a.amount, a.order_status
			from orders a, 
			    member b, 
			    order_pro c, 
			    product d
			where a.user_idx=b.user_idx
			    and b.user_idx=c.user_idx
			    and c.pro_idx=d.pro_idx
			)a )b
		where rnum<![CDATA[>=]]>#{start} and rnum<![CDATA[<=]]>#{end}
	</select>
	<select id="reportTotalCnt" resultType="Integer">
		select count(*) from
			orders
	</select>
  </mapper>